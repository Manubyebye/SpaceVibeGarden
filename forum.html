<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Vibe Garden Forum - Cannabis Cultivation Community</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Raleway:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="img/cosmigrow2.png">
    <link rel="stylesheet" href="forum-styles.css">
</head>
<body data-theme="dark">
    <!-- Particle Background -->
    <div id="particles-js"></div>

    <!-- Leaf Animation Container -->
    <div id="leaf-container" class="leaf-container"></div>
    
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="img/cosmigrow2.png" alt="Cosmic Grow Logo" class="logo-img">
                <span class="logo-text">Cosmic Grow</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="gallery.html" class="nav-link">Gallery</a></li>
                <li><a href="forum.html" class="nav-link active">Forum</a></li>
                <li><a href="yield-calculator.html" class="nav-link" id="calculator-nav">Yield Calc</a></li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Login/Register Modal -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h2 id="auth-title">Login to Forum</h2>
                <button class="auth-close">&times;</button>
            </div>
            <div class="auth-modal-body">
                <!-- Login Form - WITH FORGOT PASSWORD LINK ADDED -->
                <div id="login-form" class="auth-form active">
                    <div class="form-group">
                        <input type="email" id="login-email" placeholder="Email address" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="login-password" placeholder="Password" required>
                    </div>
                    <!-- FORGOT PASSWORD LINK ADDED HERE -->
                    <div class="form-group text-right">
                        <a href="#" id="forgot-password-link" class="forgot-password">Forgot password?</a>
                    </div>
                    <div class="form-group remember">
                        <input type="checkbox" id="remember-me">
                        <label for="remember-me">Remember me</label>
                    </div>
                    <button id="login-btn" class="btn-primary btn-full">Login</button>
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    <button id="show-register" class="btn-secondary btn-full">Create New Account</button>
                    <p class="auth-note">By logging in, you agree to our <a href="#">Terms</a> and <a href="#">Privacy Policy</a></p>
                </div>
                
                <div id="register-form" class="auth-form">
                    <div class="form-group">
                        <input type="text" id="register-username" placeholder="Choose a username" required>
                    </div>
                    <div class="form-group">
                        <input type="email" id="register-email" placeholder="Email address" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="register-password" placeholder="Create password" required>
                    </div>
                    <div class="form-group">
                        <input type="password" id="register-confirm" placeholder="Confirm password" required>
                    </div>
                    <div class="form-group remember">
                        <input type="checkbox" id="agree-terms" required>
                        <label for="agree-terms">I agree to the <a href="#">Terms</a> and <a href="#">Privacy Policy</a></label>
                    </div>
                    <button id="register-btn" class="btn-primary btn-full">Create Account</button>
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    <button id="show-login" class="btn-secondary btn-full">Already have an account? Login</button>
                </div>
                
                <div id="auth-success" class="auth-success">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3 id="success-message">Login Successful!</h3>
                    <p id="success-detail">Welcome back to the community</p>
                    <button id="continue-btn" class="btn-primary btn-full">Continue to Forum</button>
                </div>
            </div>
        </div>
    </div>

    <!-- PASSWORD RESET MODAL - ADDED HERE -->
    <div id="reset-password-modal" class="auth-modal">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h2>Reset Password</h2>
                <button class="reset-password-close auth-close">&times;</button>
            </div>
            <div class="auth-modal-body">
                <div id="reset-form" class="auth-form active">
                    <p class="reset-instruction">Enter your email address and we'll send you a link to reset your password.</p>
                    <div class="form-group">
                        <input type="email" id="reset-email" placeholder="Your email address" required>
                    </div>
                    <button id="send-reset-link" class="btn-primary btn-full">Send Reset Link</button>
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    <button id="back-to-login" class="btn-secondary btn-full">Back to Login</button>
                </div>
                
                <div id="reset-success" class="auth-success" style="display: none;">
                    <div class="success-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h3>Check Your Email</h3>
                    <p>We've sent a password reset link to your email address.</p>
                    <button id="reset-continue" class="btn-primary btn-full">Return to Login</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Messages Modal -->
    <div id="messages-modal" class="messages-modal">
        <div class="messages-modal-content">
            <div class="messages-modal-header">
                <h2><i class="fas fa-envelope"></i> Private Messages</h2>
                <button class="messages-modal-close">&times;</button>
            </div>
            <div class="messages-modal-body">
                <div class="messages-layout">
                    <div class="conversations-list">
                        <div class="conversations-header">
                            <h3>Conversations</h3>
                            <button id="new-message-btn" class="btn-primary btn-small">
                                <i class="fas fa-plus"></i> New
                            </button>
                        </div>
                        <div id="conversations-container" class="conversations-container">
                            <div class="loading-conversations">
                                <i class="fas fa-spinner fa-spin"></i> Loading...
                            </div>
                        </div>
                    </div>
                    <div class="message-thread">
                        <div id="active-conversation-header" class="active-conversation-header" style="display: none;">
                            <div class="conversation-user-info">
                                <img id="conversation-avatar" src="" alt="Avatar">
                                <div>
                                    <h4 id="conversation-username">Username</h4>
                                    <span id="conversation-badge" class="user-badge"></span>
                                </div>
                            </div>
                        </div>
                        <div id="messages-container" class="messages-container">
                            <div class="no-conversation-selected">
                                <i class="fas fa-envelope-open"></i>
                                <h3>Select a conversation</h3>
                                <p>Choose a user to start messaging</p>
                            </div>
                        </div>
                        <div id="message-input-container" class="message-input-container" style="display: none;">
                            <textarea id="message-input" placeholder="Type your message..." rows="2"></textarea>
                            <button id="send-message-btn" class="btn-primary">
                                <i class="fas fa-paper-plane"></i> Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Message Modal -->
    <div id="new-message-modal" class="new-message-modal">
        <div class="new-message-modal-content">
            <div class="new-message-modal-header">
                <h2>New Message</h2>
                <button class="new-message-modal-close">&times;</button>
            </div>
            <div class="new-message-modal-body">
                <div class="form-group">
                    <label>To:</label>
                    <select id="message-recipient" class="user-select">
                        <option value="">Select a user...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Message:</label>
                    <textarea id="new-message-content" placeholder="Write your message..." rows="5"></textarea>
                </div>
                <div class="new-message-actions">
                    <button id="cancel-new-message" class="btn-secondary">Cancel</button>
                    <button id="send-new-message" class="btn-primary">Send Message</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Forum Hero Section -->
    <section class="forum-hero-section">
        <div class="forum-hero-overlay">
            <div class="container">
                <div class="forum-hero-content">
                    <h1 class="forum-hero-title">Cannabis <span class="highlight">Growers</span> Forum</h1>
                    <p class="forum-hero-subtitle">Share experiences, ask questions, and connect with fellow cultivators</p>
                    <div id="user-welcome" class="user-welcome">
                        <p>Welcome to our community! <a href="#" id="open-login">Login</a> or <a href="#" id="open-register">Register</a> to join the discussion.</p>
                    </div>
                    <div id="logged-in-user" class="logged-in-user" style="display: none;">
                        <div class="user-info">
                            <div class="user-avatar" id="user-avatar-clickable" style="cursor: pointer;">
                                <img id="user-avatar-img" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%234CAF50'/><text x='50' y='70' font-size='40' text-anchor='middle' fill='white'>ðŸŒ¿</text></svg>" alt="Avatar" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
                            </div>
                            <div>
                                <h3 id="username-display" style="cursor: pointer;">
                                    <span id="username-text">Username</span>
                                    <span id="user-badge-display" class="user-badge"></span>
                                </h3>
                                <button id="logout-btn" class="btn-secondary btn-small">Logout</button>
                            </div>
                        </div>
                        <div class="user-actions">
                            <button id="create-post-btn" class="btn-primary">
                                <i class="fas fa-plus"></i> Create Post
                            </button>
                            <button id="profile-btn" class="btn-secondary btn-small">
                                <i class="fas fa-user"></i> Profile
                            </button>
                            <button id="messages-btn" class="btn-secondary btn-small">
                                <i class="fas fa-envelope"></i> Messages
                                <span id="nav-unread-badge" class="unread-badge-small" style="display: none;">0</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- User Profile Modal -->
    <div id="profile-modal" class="profile-modal">
        <div class="profile-modal-content">
            <div class="profile-modal-header">
                <h2>Your Profile</h2>
                <button class="profile-modal-close">&times;</button>
            </div>
            <div class="profile-modal-body">
                <div class="profile-avatar-section">
                    <div class="profile-avatar-preview">
                        <img id="avatar-preview" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%234CAF50'/><text x='50' y='70' font-size='40' text-anchor='middle' fill='white'>ðŸŒ¿</text></svg>" alt="Avatar">
                    </div>
                    <div class="profile-avatar-upload">
                        <label for="avatar-upload" class="btn-secondary">
                            <i class="fas fa-camera"></i> Change Avatar
                        </label>
                        <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                        <button id="remove-avatar" class="btn-small btn-danger" style="display: none;">
                            <i class="fas fa-trash"></i> Remove
                        </button>
                    </div>
                    <p class="avatar-hint">Recommended: Square image, max 2MB</p>
                </div>
                
                <div class="profile-info-section">
                    <h3>Profile Information</h3>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="profile-username" readonly>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="profile-email" readonly>
                    </div>
                    <div class="form-group">
                        <label>Bio</label>
                        <textarea id="profile-bio" placeholder="Tell us about your grows..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="profile-location" placeholder="City, Country">
                    </div>
                    <div class="profile-stats">
                        <div class="stat">
                            <span class="stat-value" id="profile-post-count">0</span>
                            <span class="stat-label">Posts</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="profile-comment-count">0</span>
                            <span class="stat-label">Comments</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="profile-join-date">2026</span>
                            <span class="stat-label">Member</span>
                        </div>
                    </div>
                    <div class="profile-badge-section">
                        <h4>Your Rank</h4>
                        <div id="profile-badge-display" class="profile-badge">
                            <span id="badge-icon">ðŸŒ±</span>
                            <span id="badge-name">Seedling</span>
                        </div>
                        <div class="badge-progress">
                            <div class="progress-label">
                                <span>Next Rank:</span>
                                <span id="next-rank">Grower</span>
                            </div>
                            <div class="progress-bar">
                                <div id="rank-progress" class="progress-fill" style="width: 0%;"></div>
                            </div>
                            <div class="progress-stats">
                                <span id="current-posts">0</span>/<span id="posts-needed">10</span> posts
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-actions">
                    <button id="save-profile" class="btn-primary">Save Changes</button>
                    <button id="cancel-profile" class="btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Post Modal -->
    <div id="create-post-modal" class="create-post-modal">
        <div class="create-post-content">
            <div class="create-post-header">
                <h2>Create New Post</h2>
                <button class="create-post-close">&times;</button>
            </div>
            <div class="create-post-body">
                <div class="form-group">
                    <input type="text" id="post-title" placeholder="Post Title" required>
                </div>
                <div class="form-group">
                    <select id="post-category">
                        <option value="">Select Category</option>
                        <option value="germination">Germination</option>
                        <option value="vegetative">Vegetative Stage</option>
                        <option value="flowering">Flowering Stage</option>
                        <option value="harvest">Harvest & Curing</option>
                        <option value="equipment">Equipment & Setup</option>
                        <option value="problems">Problem Solving</option>
                        <option value="strains">Strains & Genetics</option>
                        <option value="general">General Discussion</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="post-image" class="btn-secondary">
                        <i class="fas fa-camera"></i> Add Photos
                    </label>
                    <input type="file" id="post-image" accept="image/*" multiple style="display: none;">
                    <div id="image-preview-container" class="image-preview-container"></div>
                </div>
                <div class="form-group">
                    <textarea id="post-content" placeholder="What would you like to share?" rows="8" required></textarea>
                </div>
                <div class="form-group">
                    <input type="text" id="post-tags" placeholder="Add tags (separate by commas)">
                </div>
                <div class="create-post-actions">
                    <button id="cancel-post" class="btn-secondary">Cancel</button>
                    <button id="submit-post" class="btn-primary">Post to Forum</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Forum Content -->
    <section class="section">
        <div class="container">
            <div class="forum-layout">
                <!-- Sidebar -->
                <div class="forum-sidebar">
                    <div class="sidebar-section">
                        <h3><i class="fas fa-fire"></i> Trending Now</h3>
                        <ul class="trending-list">
                            <li><a href="#"><i class="fas fa-arrow-up"></i> Best nutrients for flowering stage</a></li>
                            <li><a href="#"><i class="fas fa-arrow-up"></i> LED vs HPS lighting comparison</a></li>
                            <li><a href="#"><i class="fas fa-arrow-up"></i> How to deal with spider mites</a></li>
                            <li><a href="#"><i class="fas fa-arrow-up"></i> My first grow journal - Apple Fritter</a></li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <h3><i class="fas fa-tags"></i> Categories</h3>
                        <ul class="category-list">
                            <li><a href="#" data-category="all" class="active"><i class="fas fa-layer-group"></i> All Posts</a></li>
                            <li><a href="#" data-category="germination"><i class="fas fa-seedling"></i> Germination</a></li>
                            <li><a href="#" data-category="vegetative"><i class="fas fa-leaf"></i> Vegetative</a></li>
                            <li><a href="#" data-category="flowering"><i class="fas fa-cannabis"></i> Flowering</a></li>
                            <li><a href="#" data-category="harvest"><i class="fas fa-cut"></i> Harvest</a></li>
                            <li><a href="#" data-category="equipment"><i class="fas fa-tools"></i> Equipment</a></li>
                            <li><a href="#" data-category="problems"><i class="fas fa-question-circle"></i> Problems</a></li>
                            <li><a href="#" data-category="strains"><i class="fas fa-dna"></i> Strains</a></li>
                            <li><a href="#" data-category="general"><i class="fas fa-comments"></i> General</a></li>
                        </ul>
                    </div>
                    
                    <div class="sidebar-section">
                        <h3><i class="fas fa-chart-line"></i> Forum Stats</h3>
                        <div class="stats-compact">
                            <div class="stat-compact">
                                <span class="stat-number" id="total-posts">1</span>
                                <span class="stat-label">POSTS</span>
                            </div>
                            <div class="stat-compact">
                                <span class="stat-number" id="total-users">1</span>
                                <span class="stat-label">USERS</span>
                            </div>
                            <div class="stat-compact">
                                <span class="stat-number" id="total-comments">0</span>
                                <span class="stat-label">COMMENTS</span>
                            </div>
                            <div class="stat-compact">
                                <span class="stat-number" id="total-messages">0</span>
                                <span class="stat-label">MESSAGES</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sidebar-section rules">
                        <h3><i class="fas fa-gavel"></i> Community Rules</h3>
                        <ul>
                            <li><i class="fas fa-check-circle"></i> Be respectful to others</li>
                            <li><i class="fas fa-check-circle"></i> No illegal activity discussion</li>
                            <li><i class="fas fa-check-circle"></i> Share knowledge, not misinformation</li>
                            <li><i class="fas fa-check-circle"></i> Keep discussions cultivation-focused</li>
                            <li><i class="fas fa-check-circle"></i> No commercial advertising</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div class="forum-main">
                    <!-- Forum Filters -->
                    <div class="forum-filters">
                        <div class="filter-options">
                            <button class="filter-btn active" data-filter="newest">Newest</button>
                            <button class="filter-btn" data-filter="popular">Popular</button>
                            <button class="filter-btn" data-filter="trending">Trending</button>
                            <button class="filter-btn" data-filter="unanswered">Unanswered</button>
                        </div>
                        <div class="forum-search">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="Search forum..." id="forum-search">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Posts Container -->
                    <div id="posts-container" class="posts-container">
                        <div class="loading-posts">
                            <div class="loading-spinner">
                                <i class="fas fa-cannabis fa-spin"></i>
                            </div>
                            <p>Loading forum posts...</p>
                        </div>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="empty-state" class="empty-state" style="display: none;">
                        <i class="fas fa-comment-slash"></i>
                        <h3>No posts found</h3>
                        <p>Be the first to start a discussion in this category!</p>
                    </div>
                    
                    <!-- Load More -->
                    <div class="load-more-container" style="display: none;">
                        <button id="load-more-posts" class="btn-secondary">Load More Posts</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Post Detail Modal -->
    <div id="post-detail-modal" class="post-detail-modal">
        <div class="post-detail-content">
            <div class="post-detail-header">
                <button class="post-detail-close">&times;</button>
            </div>
            <div class="post-detail-body">
                <!-- Content will be loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="img/cosmigrow2.png" alt="Cosmic Grow Logo" class="footer-logo-img">
                </div>
                
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <div class="links-grid-columns">
                        <!-- Column 1 -->
                        <div class="link-column">
                            <a href="index.html" class="footer-link">Home</a>
                            <a href="https://hiseed.cz" target="_blank" rel="noopener noreferrer" class="footer-link">Hiseeds</a>
                        </div>
                        
                        <!-- Column 2 -->
                        <div class="link-column">
                            <a href="forum.html" class="footer-link">Forum</a>
                            <a href="https://higarden.cz" target="_blank" rel="noopener noreferrer" class="footer-link">HiGarden</a>
                        </div>
                        
                        <!-- Column 3 -->
                        <div class="link-column">
                            <a href="gallery.html" class="footer-link">Gallery</a>
                            <a href="#contact" class="footer-link">Contact</a>
                        </div>
                    </div>
                </div>
                
                <div class="footer-social">
                    <h4>Follow Our Journey</h4>
                    <div class="social-icons">
                        <a href="https://www.instagram.com/cosmic_grow/"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.facebook.com/profile.php?id=61587952298967"><i class="fab fa-facebook"></i></a>
                        <a href="https://wa.me/420739237198"><i class="fab fa-whatsapp"></i></a>
                        <a href="https://t.me/+8Y-0z2lLxWdkZGQ0"><i class="fab fa-telegram"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2026 Space Vibe Garden. All rights reserved. | Legal cultivation in the Czech Republic</p>
                <p class="disclaimer">This website is for educational purposes only. All cultivation is done in compliance with Czech law.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript Files -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="script.js"></script>
    <script src="forum-script-final.js?v=1"></script>
</body>
</html>